<script context="module">
  import gsap from "gsap";
  import { columns } from "$lib/util/store";
  import { get } from "svelte/store";

  const scales = { 3: 0.06, 2: 0.1, 1: 0.1 };
  let animatedOut = false;
  let mainTitleLong;

  export function animateMainTitleOut() {
    if (animatedOut) {
      return;
    }

    gsap.to(mainTitleLong, {
      duration: 0.8,
      scale: scales[get(columns)],
      ease: "Power1.easeInOut",
    });
    animatedOut = true;
  }

  columns.subscribe((col) => {
    animatedOut = false;
  });
</script>

<div class="main-title">
  <svg
    class="main-title-short-svg"
    viewBox="0 0 356 111"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M45.4989 35.3414C37.9617 35.3414 32.3842 37.6026 28.0126 41.0697L31.1783 19.8148H73.688V0.368866L11.2801 0.0673828L2.6877 61.8723L24.9978 63.229C28.6156 58.5559 32.8364 54.4859 41.8811 54.4859C51.2272 54.4859 58.4629 62.3245 58.4629 71.9721C58.4629 81.6197 51.5287 90.5136 41.5796 90.5136C31.6305 90.5136 26.2037 84.7853 24.244 79.2078L0.728027 79.66C4.19513 93.3777 12.1845 110.563 42.0318 110.563C64.1911 110.563 81.9789 94.4329 81.9789 72.2736C81.9789 49.8128 67.3567 35.3414 45.4989 35.3414Z"
      fill="#1B1A1A"
    />
    <path
      class="blink"
      d="M92.7205 35.4921V57.0485H115.784V35.4921H92.7205ZM92.7205 86.4435V108H115.784V86.4435H92.7205Z"
      fill="#1B1A1A"
    />
    <path
      d="M202.879 108H229.56L191.573 0.368866H160.068L121.779 108H148.008L156.45 82.6749H194.588L202.879 108ZM175.594 23.5834L188.106 62.9275H162.781L175.293 23.5834H175.594Z"
      fill="#1B1A1A"
    />
    <path
      d="M238.08 108H261.294V32.1758H261.747L284.961 108H308.929L331.993 32.1758H332.445V108H355.66V0.368866H320.235L297.624 77.7004H297.473L273.655 0.368866H238.08V108Z"
      fill="#1B1A1A"
    />
  </svg>

  <svg
    bind:this={mainTitleLong}
    class="main-title-long-svg"
    viewBox="0 0 1125 191"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M73.9618 190.064C115.618 190.064 144.32 165.172 144.32 126.564C144.32 89.734 117.65 66.874 84.3758 66.874C68.6278 66.874 56.9438 71.446 50.5938 77.288H50.0858L56.1818 37H133.398V4.38998H25.4478L7.66776 108.276H47.7998C52.3718 102.434 61.5158 97.608 72.6918 97.608C89.4558 97.608 101.14 108.53 101.14 126.31C101.14 143.836 90.2178 156.028 72.9458 156.028C57.4518 156.028 45.0058 148.662 42.2118 133.93H0.301758C4.36576 171.014 34.0838 190.064 73.9618 190.064Z"
      fill="#1B1A1A"
    />
    <path
      class="blink"
      d="M153.855 186H197.289V143.328H153.855V186ZM153.855 107.26H197.289V64.588H153.855V107.26Z"
      fill="#1B1A1A"
    />
    <path
      d="M203.379 186H248.591L259.005 153.234H322.505L333.173 186H380.417L314.885 4.38998H268.657L203.379 186ZM269.419 120.976L283.389 77.034C286.437 67.636 290.755 51.38 290.755 51.38H291.263C291.263 51.38 295.327 67.636 298.375 77.034L312.091 120.976H269.419Z"
      fill="#1B1A1A"
    />
    <path
      d="M388.104 186H428.49V94.814C428.49 87.448 427.728 58.238 427.728 58.238H428.236C428.236 58.238 434.586 85.67 436.618 92.274L462.526 186H499.61L525.772 92.02C527.804 85.416 534.154 58.238 534.154 58.238H534.662C534.662 58.238 533.9 87.194 533.9 94.56V186H575.048V4.38998H514.088L491.736 83.892C488.688 95.322 481.576 125.294 481.576 125.294H481.068C481.068 125.294 473.956 95.322 470.654 83.892L448.556 4.38998H388.104V186Z"
      fill="#1B1A1A"
    />
    <path
      d="M674.174 148.154V41.982H701.098C729.292 41.982 745.294 63.318 745.294 96.338C745.294 129.612 730.054 148.154 700.59 148.154H674.174ZM629.216 186H703.892C726.752 186 745.04 180.158 759.264 169.49C779.584 153.996 790.76 128.342 790.76 96.338C790.76 40.712 756.978 4.38998 706.686 4.38998H629.216V186Z"
      fill="#1B1A1A"
    />
    <path
      d="M779.115 186H824.327L834.741 153.234H898.241L908.909 186H956.153L890.621 4.38998H844.393L779.115 186ZM845.155 120.976L859.125 77.034C862.173 67.636 866.491 51.38 866.491 51.38H866.999C866.999 51.38 871.063 67.636 874.111 77.034L887.827 120.976H845.155Z"
      fill="#1B1A1A"
    />
    <path
      d="M1034.98 153.742C1005.77 153.742 990.785 128.596 990.785 95.576C990.785 62.556 1005.77 37.156 1034.98 37.156C1064.44 37.156 1078.92 62.556 1078.92 95.576C1078.92 128.596 1064.44 153.742 1034.98 153.742ZM1034.73 190.318C1089.84 190.318 1124.64 149.932 1124.64 95.576C1124.64 41.22 1089.84 0.833984 1034.73 0.833984C979.863 0.833984 945.065 41.22 945.065 95.576C945.065 149.932 979.863 190.318 1034.73 190.318Z"
      fill="#1B1A1A"
    />
  </svg>
</div>

<style lang="scss">
  @import "../../styles/mixins.scss";

  .main-title-long-svg {
    position: fixed;
    transform-origin: left center;
    will-change: transform;
  }

  .main-title-long-svg,
  .main-title-short-svg {
    width: 100%;
  }

  .main-title-long-svg {
    display: none;
  }

  @include column-count("2") {
    .main-title-long-svg {
      display: block;
      width: calc(800px - 80px);
    }

    .main-title-short-svg {
      display: none;
    }
  }

  @include column-count("3") {
    .main-title-long-svg {
      width: calc(1240px - 80px);
    }
  }

  .blink {
    animation: blink-animation 2s steps(2, start) infinite;
  }

  @keyframes blink-animation {
    to {
      visibility: hidden;
    }
  }
</style>
